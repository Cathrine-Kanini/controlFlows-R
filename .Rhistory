print(examples)
}
} else {
cat("No students provided reasons\n")
}
} else {
cat("Reasons column not found\n")
}
# Q7: Is there an association between gender and where they reside while out of session?
cat("Q7: Association between gender and residence out of session\n")
gender_residence_table <- data_clean %>%
filter(!is.na(what_is_your_gender) &
!is.na(where_do_you_reside_while_out_of_session)) %>%
select(what_is_your_gender, where_do_you_reside_while_out_of_session)
if(nrow(gender_residence_table) > 0) {
# Chi-square test for association
chi_test <- chisq.test(table(gender_residence_table))
cat("Chi-square test results:\n")
cat("X-squared =", round(chi_test$statistic, 3),
", df =", chi_test$parameter,
", p-value =", format.pval(chi_test$p.value, digits = 3), "\n\n")
} else {
cat("Not enough data for chi-square test\n\n")
}
# 1. Create a 'residence' column based on who the student stays with
myhivdata1 <- myhivdata1 %>%
mutate(
residence_out_of_session = case_when(
who_do_you_usually_live_with_while_not_in_session_mother == "Yes" &
who_do_you_usually_live_with_while_not_in_session_father == "Yes" ~ "Both Parents",
who_do_you_usually_live_with_while_not_in_session_mother == "Yes" |
who_do_you_usually_live_with_while_not_in_session_father == "Yes" ~ "One Parent",
TRUE ~ "Other"  # e.g., relatives, rented, guardian, etc.
)
)
# 1. Create a 'residence' column based on who the student stays with
data_clean <- data_clean %>%
mutate(
residence_out_of_session = case_when(
who_do_you_usually_live_with_while_not_in_session_mother == "Yes" &
who_do_you_usually_live_with_while_not_in_session_father == "Yes" ~ "Both Parents",
who_do_you_usually_live_with_while_not_in_session_mother == "Yes" |
who_do_you_usually_live_with_while_not_in_session_father == "Yes" ~ "One Parent",
TRUE ~ "Other"  # e.g., relatives, rented, guardian, etc.
)
)
# 2. Create a contingency table of gender vs residence
residence_table <- table(myhivdata1$what_is_your_gender, myhivdata1$residence_out_of_session)
# 1. Create a 'residence' column based on who the student stays with
data_clean <- data_clean %>%
mutate(
residence_out_of_session = case_when(
who_do_you_usually_live_with_while_not_in_session_mother == "Yes" &
who_do_you_usually_live_with_while_not_in_session_father == "Yes" ~ "Both Parents",
who_do_you_usually_live_with_while_not_in_session_mother == "Yes" |
who_do_you_usually_live_with_while_not_in_session_father == "Yes" ~ "One Parent",
TRUE ~ "Other"  # e.g., relatives, rented, guardian, etc.
)
)
# 2. Create a contingency table of gender vs residence
residence_table <- table(myhivdata1$what_is_your_gender, myhivdata1$residence_out_of_session)
# 1. Create a 'residence' column based on who the student stays with
data_clean <- data_clean %>%
mutate(
residence_out_of_session = case_when(
who_do_you_usually_live_with_while_not_in_session_mother == "Yes" &
who_do_you_usually_live_with_while_not_in_session_father == "Yes" ~ "Both Parents",
who_do_you_usually_live_with_while_not_in_session_mother == "Yes" |
who_do_you_usually_live_with_while_not_in_session_father == "Yes" ~ "One Parent",
TRUE ~ "Other"  # e.g., relatives, rented, guardian, etc.
)
)
# 2. Create a contingency table of gender vs residence
residence_table <- table(data_clean$what_is_your_gender, data_clean$residence_out_of_session)
residence_table
# 3. Calculate row-wise percentages (distribution within each gender)
prop.table(residence_table, 1) * 100
# 4. Chi-square test for association
chisq_result <- chisq.test(residence_table)
chisq_result
# Q7: Is there an association between gender and where they reside while out of session?
cat("Q7: Association between gender and residence out of session\n")
gender_residence_table <- data_clean %>%
filter(!is.na(what_is_your_gender) &
!is.na(where_do_you_reside_while_out_of_session)) %>%
select(what_is_your_gender, where_do_you_reside_while_out_of_session)
if(nrow(gender_residence_table) > 0) {
# Chi-square test for association
chi_test <- chisq.test(table(gender_residence_table))
cat("Chi-square test results:\n")
cat("X-squared =", round(chi_test$statistic, 3),
", df =", chi_test$parameter,
", p-value =", format.pval(chi_test$p.value, digits = 3), "\n\n")
} else {
cat("Not enough data for chi-square test\n\n")
}
# Q7: Association between gender and residence (who they live with)
cat("Q7: Association between gender and residence out of session\n\n")
# 1. Create residence variable (as in second code)
data_clean <- data_clean %>%
mutate(
residence_who = case_when(
who_do_you_usually_live_with_while_not_in_session_mother == "Yes" &
who_do_you_usually_live_with_while_not_in_session_father == "Yes" ~ "Both Parents",
who_do_you_usually_live_with_while_not_in_session_mother == "Yes" |
who_do_you_usually_live_with_while_not_in_session_father == "Yes" ~ "One Parent",
TRUE ~ "Other"
)
)
# 2. Filter for analysis (keep only complete cases for these variables)
analysis_data <- data_clean %>%
filter(!is.na(what_is_your_gender) & !is.na(residence_who))
cat("Sample size for analysis:", nrow(analysis_data), "\n\n")
# 3. Create and display contingency table
residence_table <- table(analysis_data$what_is_your_gender, analysis_data$residence_who)
cat("Contingency Table (Counts):\n")
print(residence_table)
cat("\n")
# 4. Show row percentages (within each gender)
cat("Row Percentages (% within each gender):\n")
print(round(prop.table(residence_table, 1) * 100, 1))
cat("\n")
# 5. Chi-square test with conditions
if(all(dim(residence_table) >= 2) &&
sum(residence_table) > 0 &&
all(colSums(residence_table) > 0) &&
all(rowSums(residence_table) > 0)) {
chi_test <- chisq.test(residence_table)
cat("Chi-square Test Results:\n")
cat("X-squared =", round(chi_test$statistic, 3),
", df =", chi_test$parameter,
", p-value =", format.pval(chi_test$p.value, digits = 3), "\n")
# Check for expected frequencies assumption
cat("\nExpected Frequencies (all should be ≥5 for valid test):\n")
print(round(chi_test$expected, 1))
} else {
cat("Cannot perform chi-square test - insufficient data or zero margins\n")
}
# Q7: Association between gender and residence (who they live with)
cat("Q7: Association between gender and residence out of session\n\n")
# 1. Create residence variable (as in second code)
data_clean <- data_clean %>%
mutate(
residence_who = case_when(
who_do_you_usually_live_with_while_not_in_session_mother == "Yes" &
who_do_you_usually_live_with_while_not_in_session_father == "Yes" ~ "Both Parents",
who_do_you_usually_live_with_while_not_in_session_mother == "Yes" |
who_do_you_usually_live_with_while_not_in_session_father == "Yes" ~ "One Parent",
TRUE ~ "Other"
)
)
# 2. Filter for analysis (keep only complete cases for these variables)
analysis_data <- data_clean %>%
filter(!is.na(what_is_your_gender) & !is.na(residence_who))
cat("Sample size for analysis:", nrow(analysis_data), "\n\n")
# 3. Create and display contingency table
residence_table <- table(analysis_data$what_is_your_gender, analysis_data$residence_who)
cat("Contingency Table (Counts):\n")
print(residence_table)
cat("\n")
# 4. Show row percentages (within each gender)
cat("Row Percentages (% within each gender):\n")
print(round(prop.table(residence_table, 1) * 100, 1))
cat("\n")
# 5. Chi-square test with conditions
if(all(dim(residence_table) >= 2) &&
sum(residence_table) > 0 &&
all(colSums(residence_table) > 0) &&
all(rowSums(residence_table) > 0)) {
chi_test <- chisq.test(residence_table)
cat("Chi-square Test Results:\n")
cat("X-squared =", round(chi_test$statistic, 3),
", df =", chi_test$parameter,
", p-value =", format.pval(chi_test$p.value, digits = 3), "\n")
# Check for expected frequencies assumption
cat("\nExpected Frequencies (all should be ≥5 for valid test):\n")
print(round(chi_test$expected, 1))
} else {
cat("Cannot perform chi-square test - insufficient data or zero margins\n")
}
# 7. Is there an association between gender and where they reside while out of session?
# Keep only complete cases for the two variables
data_clean <- data_clean %>%
filter(
!is.na(what_is_your_gender),
!is.na(where_do_you_reside_while_out_of_session)
)
# Create contingency table
tab <- table(
data_clean$what_is_your_gender,
data_clean$where_do_you_reside_while_out_of_session
)
# Display table
tab
# Row percentages (within gender)
round(prop.table(tab, 1) * 100, 1)
# Chi-square test of independence
chi_test <- chisq.test(tab)
chi_test
# Check expected counts
round(chi_test$expected, 1)
# Fisher's Exact Test with simulation (if assumptions are violated)
fisher.test(tab, simulate.p.value = TRUE, B = 10000)
# Q7: Is there an association between gender and where they reside while out of session?
cat("Q7: Association between gender and residence out of session\n")
gender_residence_table <- data_clean %>%
filter(!is.na(what_is_your_gender) &
!is.na(where_do_you_reside_while_out_of_session)) %>%
select(what_is_your_gender, where_do_you_reside_while_out_of_session)
if(nrow(gender_residence_table) > 0) {
# Chi-square test for association
chi_test <- chisq.test(table(gender_residence_table))
cat("Chi-square test results:\n")
cat("X-squared =", round(chi_test$statistic, 3),
", df =", chi_test$parameter,
", p-value =", format.pval(chi_test$p.value, digits = 3), "\n\n")
} else {
cat("Not enough data for chi-square test\n\n")
}
# Q8: How many siblings on average did self-sponsored students have?
cat("Q8: Average siblings for self-sponsored students\n")
self_sponsored_siblings <- data_clean %>%
filter(who_sponsors_your_studies == "Self sponsored" &
!is.na(how_many_siblings_do_you_have_include_yourself_brothers) &
!is.na(how_many_siblings_do_you_have_include_yourself_sisters)) %>%
mutate(
brothers = how_many_siblings_do_you_have_include_yourself_brothers,
sisters = how_many_siblings_do_you_have_include_yourself_sisters,
total_siblings = brothers + sisters - 1  # Subtract 1 because question says "include yourself"
)
if(nrow(self_sponsored_siblings) > 0) {
avg_siblings <- mean(self_sponsored_siblings$total_siblings, na.rm = TRUE)
cat("Number of self-sponsored students analyzed:", nrow(self_sponsored_siblings), "\n")
cat("Average number of siblings (excluding self) for self-sponsored students:", round(avg_siblings, 2), "\n\n")
} else {
cat("No self-sponsored students with valid sibling data found\n\n")
}
# QUESTION9: What was the source of the money that student spent while in session?
cat("9: Summary of money sources (counts)\n")
# Find all money source columns
money_source_cols <- names(data_clean)[str_detect(names(data_clean), "what_is_the_source_of_the_money")]
source_summary <- data.frame(Source = character(), Count = integer(), Percentage = numeric())
for(col in money_source_cols) {
# Extract source name from column name
source_name <- str_extract(col, "(?<=\\[).+?(?=\\])")
if(!is.na(source_name)) {
count_yes <- sum(data_clean[[col]] == "Yes", na.rm = TRUE)
total_valid <- sum(!is.na(data_clean[[col]]))
percentage <- ifelse(total_valid > 0, (count_yes / total_valid) * 100, 0)
source_summary <- rbind(source_summary,
data.frame(Source = source_name,
Count = count_yes,
Percentage = round(percentage, 2)))
}
}
print(source_summary)
cat("\n")
# QUESTION10: How many students have ever taken drug(s)?
cat("Q10: Students who have ever taken drugs\n")
# Find the drug use column
drug_col <- names(data_clean)[str_detect(names(data_clean), "have_you_ever_used_any_of_the_following_drugs")][1]
if(!is.na(drug_col)) {
drug_takers <- data_clean %>%
filter(.data[[drug_col]] == "Yes") %>%
nrow()
total_valid_drug <- data_clean %>%
filter(!is.na(.data[[drug_col]])) %>%
nrow()
drug_percentage <- ifelse(total_valid_drug > 0, (drug_takers / total_valid_drug) * 100, 0)
cat("Total valid responses about drug use:", total_valid_drug, "\n")
cat("Number of students who have ever taken drugs:", drug_takers, "\n")
cat("Percentage:", round(drug_percentage, 2), "%\n\n")
} else {
cat("Drug use column not found\n\n")
}
cat("9: Summary of money sources (counts)\n")
# Find all money source columns
money_source_cols <- names(data_clean)[str_detect(names(data_clean), "what_is_the_source_of_the_money")]
source_summary <- data.frame(Source = character(), Count = integer(), Percentage = numeric())
for(col in money_source_cols) {
# Extract source name from column name
source_name <- str_extract(col, "(?<=\\[).+?(?=\\])")
if(!is.na(source_name)) {
count_yes <- sum(data_clean[[col]] == "Yes", na.rm = TRUE)
total_valid <- sum(!is.na(data_clean[[col]]))
percentage <- ifelse(total_valid > 0, (count_yes / total_valid) * 100, 0)
source_summary <- rbind(source_summary,
data.frame(Source = source_name,
Count = count_yes,
Percentage = round(percentage, 2)))
}
}
print(source_summary)
cat("\n")
# QUESTION9: What was the source of the money that student spent while in session?
# 9.What was the source of the money that student spent while in session? Provide a table summary for the average amount from each source
money_sources_table <- data_clean %>%
select(
what_is_the_source_of_the_money_that_you_normally_spend_while_in_session_salary_and_wages_from_a_job_including_self_employment,
what_is_the_source_of_the_money_that_you_normally_spend_while_in_session_charities,
what_is_the_source_of_the_money_that_you_normally_spend_while_in_session_parents_guardians,
what_is_the_source_of_the_money_that_you_normally_spend_while_in_session_friends,
what_is_the_source_of_the_money_that_you_normally_spend_while_in_session_helb,
what_is_the_source_of_the_money_that_you_normally_spend_while_in_session_bursary,
what_is_the_source_of_the_money_that_you_normally_spend_while_in_session_other
) %>%
pivot_longer(
cols = everything(),
names_to = "source_of_money",
values_to = "response"
) %>%
filter(response == "Yes") %>%
group_by(source_of_money) %>%
summarise(
number_of_students = n()
) %>%
mutate(
percentage = round(100 * number_of_students / sum(number_of_students), 1)
)
money_sources_table
# QUESTION10: How many students have ever taken drug(s)?
cat("Q10: Students who have ever taken drugs\n")
# Find the drug use column
drug_col <- names(data_clean)[str_detect(names(data_clean), "have_you_ever_used_any_of_the_following_drugs")][1]
if(!is.na(drug_col)) {
drug_takers <- data_clean %>%
filter(.data[[drug_col]] == "Yes") %>%
nrow()
total_valid_drug <- data_clean %>%
filter(!is.na(.data[[drug_col]])) %>%
nrow()
drug_percentage <- ifelse(total_valid_drug > 0, (drug_takers / total_valid_drug) * 100, 0)
cat("Total valid responses about drug use:", total_valid_drug, "\n")
cat("Number of students who have ever taken drugs:", drug_takers, "\n")
cat("Percentage:", round(drug_percentage, 2), "%\n\n")
} else {
cat("Drug use column not found\n\n")
}
# QUESTION10: How many students have ever taken drug(s)?
cat("Q10: Students who have ever taken drugs\n")
# Find the drug use column
drug_col <- names(data_clean)[str_detect(names(data_clean), "have_you_ever_used_any_of_the_following_drugs")][1]
if(!is.na(drug_col)) {
drug_takers <- data_clean %>%
filter(.data[[drug_col]] == "Yes") %>%
nrow()
total_valid_drug <- data_clean %>%
filter(!is.na(.data[[drug_col]])) %>%
nrow()
drug_percentage <- ifelse(total_valid_drug > 0, (drug_takers / total_valid_drug) * 100, 0)
cat("Total valid responses about drug use:", total_valid_drug, "\n")
cat("Number of students who have ever taken drugs:", drug_takers, "\n")
} else {
cat("Drug use column not found\n\n")
}
# QUESTION11: Is students gender associated with drug/substance abuse?
cat("Q11: Association between gender and drug use\n")
if(!is.na(drug_col)) {
gender_drug_table <- data_clean %>%
filter(!is.na(what_is_your_gender) &
!is.na(.data[[drug_col]])) %>%
select(what_is_your_gender, drug_col)
if(nrow(gender_drug_table) > 0) {
# Create contingency table
contingency_table <- table(gender_drug_table)
cat("Contingency table:\n")
print(contingency_table)
# Chi-square test
chi_drug_test <- chisq.test(contingency_table)
cat("\nChi-square test results:\n")
cat("X-squared =", round(chi_drug_test$statistic, 3),
", df =", chi_drug_test$parameter,
", p-value =", format.pval(chi_drug_test$p.value, digits = 3), "\n\n")
} else {
cat("Not enough data for chi-square test\n\n")
}
} else {
cat("Drug use column not found\n\n")
}
# QUESTION12: Among the reasons why drug/substance use/abuse was increasing,
# how many mentioned peer pressure?
cat("Q12: Students mentioning 'peer pressure' in reasons\n")
# Find the reasons column
reasons_col <- names(data_clean)[str_detect(names(data_clean), "give_reasons_for_your_answer")][1]
if(!is.na(reasons_col)) {
total_with_reasons <- sum(!is.na(data_clean[[reasons_col]]))
cat("Total students who gave reasons:", total_with_reasons, "\n")
if(total_with_reasons > 0) {
# Count mentions of "peer" (case-insensitive)
peer_mentions <- data_clean %>%
filter(!is.na(.data[[reasons_col]])) %>%
mutate(mentions_peer = str_detect(tolower(.data[[reasons_col]]), "peer")) %>%
filter(mentions_peer == TRUE) %>%
nrow()
cat("Number of students mentioning 'peer' in their reasons:", peer_mentions, "\n")
# Also count variations like "peer pressure", "peer influence", etc.
peer_variations <- data_clean %>%
filter(!is.na(.data[[reasons_col]])) %>%
mutate(
reasons_lower = tolower(.data[[reasons_col]]),
mentions_peer_pressure = str_detect(reasons_lower, "peer pressure"),
mentions_peer_influence = str_detect(reasons_lower, "peer influence"),
mentions_peers = str_detect(reasons_lower, "peers"),
any_peer_mention = mentions_peer_pressure | mentions_peer_influence | mentions_peers
) %>%
filter(any_peer_mention == TRUE)
cat("Number of students mentioning peer-related terms (pressure/influence/peers):", nrow(peer_variations), "\n")
# Show some examples
if(nrow(peer_variations) > 0) {
cat("\nExamples of responses mentioning peer pressure:\n")
examples <- peer_variations %>%
select(all_of(reasons_col)) %>%
head(3)
print(examples)
}
} else {
cat("No students provided reasons\n")
}
} else {
cat("Reasons column not found\n")
}
# QUESTION12: Among the reasons why drug/substance use/abuse was increasing,
# how many mentioned peer pressure?
cat("Q12: Students mentioning 'peer pressure' in reasons\n")
# Find the reasons column
reasons_col <- names(data_clean)[str_detect(names(data_clean), "give_reasons_for_your_answer")][1]
if(!is.na(reasons_col)) {
total_with_reasons <- sum(!is.na(data_clean[[reasons_col]]))
cat("Total students who gave reasons:", total_with_reasons, "\n")
if(total_with_reasons > 0) {
# Count mentions of "peer" (case-insensitive)
peer_mentions <- data_clean %>%
filter(!is.na(.data[[reasons_col]])) %>%
mutate(mentions_peer = str_detect(tolower(.data[[reasons_col]]), "peer")) %>%
filter(mentions_peer == TRUE) %>%
nrow()
cat("Number of students mentioning 'peer' in their reasons:", peer_mentions, "\n")
# Also count variations like "peer pressure", "peer influence", etc.
peer_variations <- data_clean %>%
filter(!is.na(.data[[reasons_col]])) %>%
mutate(
reasons_lower = tolower(.data[[reasons_col]]),
mentions_peer_pressure = str_detect(reasons_lower, "peer pressure"),
mentions_peer_influence = str_detect(reasons_lower, "peer influence"),
mentions_peers = str_detect(reasons_lower, "peers"),
any_peer_mention = mentions_peer_pressure | mentions_peer_influence | mentions_peers
) %>%
filter(any_peer_mention == TRUE)
cat("Number of students mentioning peer-related terms (pressure/influence/peers):", nrow(peer_variations), "\n")
# Show some examples
if(nrow(peer_variations) > 0) {
cat("\nNumber of responses mentioning peer pressure:\n")
examples <- peer_variations %>%
select(all_of(reasons_col)) %>%
head(3)
print(examples)
}
} else {
cat("No students provided reasons\n")
}
} else {
cat("Reasons column not found\n")
}
knitr::opts_chunk$set(
echo = TRUE,
warning = FALSE,
message = FALSE,
comment = "#>",
fig.width = 8,
fig.height = 6
)
if (a < b) {
c <- a - b
print("condition a < b is TRUE")
print(paste("Difference between a, b is:", c))
}
```{r}
knitr::opts_chunk$set(
echo = TRUE,
warning = FALSE,
message = FALSE,
comment = "#>",
fig.width = 8,
fig.height = 6
)
a <- 76
b <- 67
if (a > b) {
c <- a - b
print("condition a > b is TRUE")
print(paste("Difference between a, b is:", c))
}
if (a < b) {
c <- a - b
print("condition a < b is TRUE")
print(paste("Difference between a, b is:", c))
}
cat("\f")
for (i in 1:10) {
if (i %% 2 == 0) {
next  # Skip even numbers
}
print(paste("Odd number:", i))
}
cat("\f")
git remote
git remote -v
git remote View
cat("\f")
git add .
git branch
cat("\f")
